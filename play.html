<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Talk to Ada</title>
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon" />

    <!-- Tailwind CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Quicksand", sans-serif;
        background: linear-gradient(to bottom right, #1e293b, #334155);
        color: #f1f5f9;
      }
      input,
      select {
        color: #94a3b8;
        background-color: #1e293b;
      }
      select option {
        color: #94a3b8;
        background-color: #1e293b;
      }
      .avatar-img-large {
        width: 12rem;
        height: 12rem;
        object-fit: cover;
        border-radius: 9999px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      }
    </style>
    <script>
      function formatAvatarName(avatar) {
        switch (avatar) {
          case "carvis":
            return "J.A.R.V.I.S. (Concise & Logical)";
          case "chortana":
            return "Cortana (Helpful & Friendly)";
          case "calfred":
            return "Alfred (Wise & Supportive)";
          case "starship-computer":
            return "Starship Computer (Precise & Formal)";
          case "code-of-duty":
            return "Code of Duty (Tactical & Focused)";
          case "ada":
            return "Ada (Empathetic & Inspiring)";
          default:
            return "Ada (Empathetic & Inspiring)";
        }
      }

      function avatarImagePath(avatar) {
        switch (avatar) {
          case "carvis":
            return "/assets/avatars/carvis.png";
          case "chortana":
            return "/assets/avatars/chortana.png";
          case "calfred":
            return "/assets/avatars/calfred.png";
          case "starship-computer":
            return "/assets/avatars/starship.png";
          case "code-of-duty":
            return "/assets/avatars/code-of-duty.png";
          case "ada":
            return "/assets/avatars/ada.png";
          default:
            return "/assets/avatars/ada.png";
        }
      }

      window.onload = () => {
        const params = new URLSearchParams(window.location.search);
        const name = params.get("name") || "Student";
        const avatar = params.get("avatar") || "chortana";
        document.getElementById(
          "personal-greeting"
        ).innerText = `Hi ${name}, I'm ${avatar}.`;
        document.getElementById(
          "avatar-persona"
        ).innerText = `Tutor Style: ${formatAvatarName(avatar)}`;

        // Update avatar image and label
        const imgEl = document.getElementById("avatar-image");
        const labelEl = document.getElementById("avatar-label");
        imgEl.src = avatarImagePath(avatar);
        imgEl.alt = formatAvatarName(avatar);
        labelEl.innerText = formatAvatarName(avatar).split(" ")[0];
      };
    </script>
  </head>

  <body class="min-h-screen">
    <!-- Header -->
    <header
      class="text-center py-6 shadow bg-white bg-opacity-10 backdrop-blur"
    >
      <h1 id="personal-greeting" class="text-3xl font-bold text-white">
        Hi, I'm Ada.
      </h1>
      <p id="avatar-persona" class="text-sm text-slate-300">
        Your AI tutor is here to help.
      </p>
    </header>

    <!-- Chat & Avatar Container -->
    <main class="flex flex-col lg:flex-row max-w-4xl mx-auto px-4 py-10 gap-6">
      <!-- Left: Chat -->
      <div class="flex-1">
        <div
          id="chat-log"
          class="bg-white bg-opacity-10 rounded-xl shadow-inner h-96 overflow-y-auto p-4 mb-6"
        ></div>

        <!-- Chat Input Form -->
        <form id="ask-form" class="flex space-x-2 items-center">
          <!-- 1. Mic button -->
          <button
            type="button"
            id="mic-btn"
            class="bg-blue-800 text-white p-3 rounded-lg hover:bg-blue-700 focus:outline-none"
            title="Start/Stop Listening"
          >
            üé§
          </button>

          <input
            type="text"
            id="user-input"
            placeholder="Ask me anything..."
            class="flex-1 p-3 border border-slate-600 bg-slate-800 text-slate-300 rounded-lg"
            required
          />

          <button
            type="button"
            id="play-btn"
            class="bg-blue-800 text-white p-3 rounded-lg hover:bg-blue-700 focus:outline-none"
            title="Speak Last Response"
          >
            üîä
          </button>

          <!-- 4. Send button -->
          <button
            type="submit"
            class="bg-pink-500 text-white px-6 py-2 rounded-lg font-semibold shadow hover:bg-pink-600"
          >
            Send
          </button>
        </form>
      </div>

      <!-- Right: Avatar Placeholder -->
      <div class="hidden lg:flex flex-col items-center w-48">
        <img
          id="avatar-image"
          class="avatar-img-large mb-4"
          src="/assets/avatars/ada.png"
          alt="Ada Avatar"
        />
        <p id="avatar-label" class="text-slate-300 text-center">Ada</p>
      </div>
    </main>

    <footer class="text-center py-4 text-sm text-slate-400">
      <a href="/" class="underline hover:text-white">‚Üê Back to Home</a>
    </footer>

    <!-- Scripts -->
    <script src="js/play.js"></script>
  </body>
</html>
